
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Marine carbonate system calculations in Python">
      
      
        <meta name="author" content="Matthew P. Humphreys">
      
      
      
        <link rel="prev" href="../adjust/">
      
      
        <link rel="next" href="../validity/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>Uncertainty propagation - PyCO2SYS</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      

  
  
  
  
  <style>:root{--md-annotation-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M17%2013h-4v4h-2v-4H7v-2h4V7h2v4h4m-5-9A10%2010%200%200%200%202%2012a10%2010%200%200%200%2010%2010%2010%2010%200%200%200%2010-10A10%2010%200%200%200%2012%202%22/%3E%3C/svg%3E');}</style>


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans:300,300i,400,400i,700,700i%7CNoto+Sans+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Noto Sans";--md-code-font:"Noto Sans Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#uncertainty-propagation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="PyCO2SYS" class="md-header__button md-logo" aria-label="PyCO2SYS" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PyCO2SYS
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Uncertainty propagation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/mvdh7/PyCO2SYS" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    mvdh7/PyCO2SYS
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="PyCO2SYS" class="md-nav__button md-logo" aria-label="PyCO2SYS" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    PyCO2SYS
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mvdh7/PyCO2SYS" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    mvdh7/PyCO2SYS
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview and installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    User guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            User guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quick/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quick-start guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../detail/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Arguments and results
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adjust/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Adjust conditions (temperature and pressure)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Uncertainty propagation
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Uncertainty propagation
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#define-independent-uncertainties" class="md-nav__link">
    <span class="md-ellipsis">
      Define independent uncertainties
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#propagate-independent-uncertainties" class="md-nav__link">
    <span class="md-ellipsis">
      Propagate independent uncertainties
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uncertainties-with-covariances" class="md-nav__link">
    <span class="md-ellipsis">
      Uncertainties with covariances
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../validity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Validity range checker
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Advanced tips and tricks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../v1_to_v2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Switching from v1 to v2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../refs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    References
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../versions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Version history
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#define-independent-uncertainties" class="md-nav__link">
    <span class="md-ellipsis">
      Define independent uncertainties
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#propagate-independent-uncertainties" class="md-nav__link">
    <span class="md-ellipsis">
      Propagate independent uncertainties
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uncertainties-with-covariances" class="md-nav__link">
    <span class="md-ellipsis">
      Uncertainties with covariances
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<div class="admonition danger">
<p class="admonition-title">PyCO2SYS v2 beta</p>
<p>These are the docs for the beta release of PyCO2SYS v2!</p>
<p>If you're here to test it, then thank you! and please report any issues via <a href="https://github.com/mvdh7/PyCO2SYS/issues">the GitHub repo</a>.</p>
<p><strong>These instructions will not work for the current version 1.8</strong> that can be installed through <code>pip</code> and <code>conda</code> - please see <a href="https://pyco2sys.readthedocs.io/en/latest/">PyCO2SYS.readthedocs.io</a> for documentation for the latest stable release.</p>
</div>
<h1 id="uncertainty-propagation">Uncertainty propagation<a class="headerlink" href="#uncertainty-propagation" title="Permanent link">&para;</a></h1>
<p>Independent uncertainties are defined and propagated with the <code>set_uncertainty</code> and <code>propagate</code> methods.</p>
<p>All derivatives needed for uncertainty propagation are calculated with automatic differentiation.</p>
<h2 id="define-independent-uncertainties">Define independent uncertainties<a class="headerlink" href="#define-independent-uncertainties" title="Permanent link">&para;</a></h2>
<p>If the uncertainty in each <a href="../detail/#keyword-arguments">argument</a> is independent – i.e. there is no covariance between the uncertainties in different parameters – then the <code>set_uncertainty</code> and <code>propagate</code> methods can be used to propagate the parameter uncertainties through into any <a href="../detail/#results">result</a>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">PyCO2SYS</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pyco2</span>

<span class="c1"># Set up the CO2System</span>
<span class="n">co2s</span> <span class="o">=</span> <span class="n">pyco2</span><span class="o">.</span><span class="n">sys</span><span class="p">(</span><span class="n">dic</span><span class="o">=</span><span class="mi">2100</span><span class="p">,</span> <span class="n">alkalinity</span><span class="o">=</span><span class="mi">2250</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Define uncertainties in the known parameters</span>
<span class="n">co2s</span><span class="o">.</span><span class="n">set_uncertainty</span><span class="p">(</span><span class="n">dic</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alkalinity</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<div class="admonition inputs">
<p class="admonition-title"><code>set_uncertainty</code> kwargs</p>
<p><code>set_uncertainty</code> can take the same kwargs as <code>pyco2.sys</code>, excepting the settings (keys beginning with <code>"opt_"</code>).  It is not necessary to provide an uncertainty for every parameter - those that are not specified are assumed to have zero uncertainty.</p>
<p>The values provided should be the 1<i>σ</i> uncertainty in each parameter.  They can be single scalar values or arrays matching the shape of the correpsonding parameter.</p>
<p>To provide a fractional value for any uncertainty, append <code>"__f"</code> to the end of its key in <code>uncertainty_from</code>.</p>
</div>
<p>The "standard" uncertainties in the equilbrium constants and total borate used by CO2SYS for MATLAB following <a href="../refs/#o">OEDG18</a> are available as a dict in the correct format for <code>set_uncertainty</code> at <code>pyco2.uncertainty_OEDG18</code>:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Also include equilibrium constant uncertainties</span>
<span class="n">co2s</span><span class="o">.</span><span class="n">set_uncertainty</span><span class="p">(</span><span class="o">**</span><span class="n">pyco2</span><span class="o">.</span><span class="n">uncertainty_OEDG18</span><span class="p">)</span>
</code></pre></div>
<p>If <code>set_uncertainty</code> is run multiple times on the same <code>CO2System</code>, each successive call adds to the existing set of uncertainties, overwriting where an uncertainty for that parameter was already declared.</p>
<div class="admonition warn">
<p class="admonition-title"><code>set_uncertainty</code> after <code>propagate</code></p>
<p>If <code>set_uncertainty</code> is run after running <code>propagate</code> on a system, then <code>propagate</code> will automatically be run again with the new set uncertainties, so that the values in <code>co2s.uncertainty</code> are all correct for the current set of assigned uncertainties.</p>
</div>
<h2 id="propagate-independent-uncertainties">Propagate independent uncertainties<a class="headerlink" href="#propagate-independent-uncertainties" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="c1"># Propagate uncertainties set with set_uncertainty</span>
<span class="n">co2s</span><span class="o">.</span><span class="n">propagate</span><span class="p">([</span><span class="s2">&quot;pH&quot;</span><span class="p">,</span> <span class="s2">&quot;fCO2&quot;</span><span class="p">])</span>

<span class="c1"># Access uncertainty results</span>
<span class="n">uncert_fCO2</span> <span class="o">=</span> <span class="n">co2s</span><span class="o">.</span><span class="n">uncertainty</span><span class="p">[</span><span class="s2">&quot;fCO2&quot;</span><span class="p">]</span>
<span class="n">uncert_pH_due_to_dic</span> <span class="o">=</span> <span class="n">co2s</span><span class="o">.</span><span class="n">uncertainty</span><span class="p">[</span><span class="s2">&quot;pH&quot;</span><span class="p">][</span><span class="s2">&quot;dic&quot;</span><span class="p">]</span>
</code></pre></div>
<p>The total uncertainties are the Pythagorean sum of all the components.  This calculation assumes that all argument uncertainties are independent from each other and that they are provided in terms of single standard deviations.</p>
<div class="admonition inputs">
<p class="admonition-title"><code>propagate</code> arguments</p>
<ul>
<li><code>uncertainty_into</code>: a list of the parameter keys that uncertainties are to be propagated into.</li>
</ul>
<p>If <code>propagate</code> is run with no arguments, then uncertainties will be propagated into all results that have been currently solved for.</p>
</div>
<div class="admonition outputs">
<p class="admonition-title"><code>propagate</code> results</p>
<p>The uncertainty results are stored in <code>co2s.uncertainty</code>, for which <code>co2s.u</code> can be used as a shortcut.</p>
<ul>
<li>
<p>For each result <code>into</code> in <code>uncertainty_into</code>, there is a new sub-dict <code>co2s.uncertainty[into]</code> containing the total and component uncertainties in that result.</p>
</li>
<li>
<p>The total uncertainty is in <code>co2s.uncertainty[into]</code>.</p>
</li>
<li>
<p>The uncertainties from each argument <code>from</code> that has had an uncertainty defined with <code>set_uncertainty</code> are also in the sub-dict with the corresponding keys: <code>co2s.uncertainty[into][from]</code>.</p>
</li>
</ul>
<p>All <code>into</code> and <code>from</code> values can be accessed with dot notation instead of with square brackets, and the <a href="../detail/#arguments-and-results">shortcuts</a> can be used.</p>
</div>
<h2 id="uncertainties-with-covariances">Uncertainties with covariances<a class="headerlink" href="#uncertainties-with-covariances" title="Permanent link">&para;</a></h2>
<p>PyCO2SYS does not currently have a generalised function for the complete process of propagating uncertainties that co-vary.  However, it does allow the derivative of any result with respect to any argument to be calculated:</p>
<div class="highlight"><pre><span></span><code><span class="n">grads_of</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;pH&quot;</span><span class="p">]</span>  <span class="c1"># Get derivatives of pH...</span>
<span class="n">grads_wrt</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;dic&quot;</span><span class="p">,</span> <span class="s2">&quot;alkalinity&quot;</span><span class="p">]</span>  <span class="c1"># ... with respect to DIC and alkalinity</span>
<span class="n">co2s</span><span class="o">.</span><span class="n">get_grads</span><span class="p">(</span><span class="n">grads_of</span><span class="p">,</span> <span class="n">grads_wrt</span><span class="p">)</span>

<span class="c1"># Access derivatives - shortcuts and dot notation can be used</span>
<span class="n">dpH_ddic</span> <span class="o">=</span> <span class="n">co2s</span><span class="o">.</span><span class="n">grads</span><span class="p">[</span><span class="s2">&quot;pH&quot;</span><span class="p">][</span><span class="s2">&quot;dic&quot;</span><span class="p">]</span>
<span class="n">dpH_dalk</span> <span class="o">=</span> <span class="n">co2s</span><span class="o">.</span><span class="n">grads</span><span class="p">[</span><span class="s2">&quot;pH&quot;</span><span class="p">][</span><span class="s2">&quot;alkalinity&quot;</span><span class="p">]</span>
</code></pre></div>
<div class="admonition inputs">
<p class="admonition-title"><code>get_grads</code> arguments</p>
<ul>
<li><code>grads_of</code>: a list of parameter keys for which the derivatives of are to be calculated.</li>
<li><code>grads_wrt</code>: a list of parameter keys for which the derivatives with respect to are to be calculated.</li>
</ul>
</div>
<div class="admonition outputs">
<p class="admonition-title"><code>get_grads</code> results</p>
<p>For each result <code>of</code> in <code>grads_of</code> and argument <code>wrt</code> in <code>grads_wrt</code>, the corresponding derivative is stored in <code>co2s.grads[of][wrt]</code>.</p>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../adjust/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Adjust conditions (temperature and pressure)">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Adjust conditions (temperature and pressure)
              </div>
            </div>
          </a>
        
        
          
          <a href="../validity/" class="md-footer__link md-footer__link--next" aria-label="Next: Validity range checker">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Validity range checker
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2020-2025 Matthew P. Humphreys (GNU GPLv3)
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.footer", "content.code.copy", "navigation.expand", "content.tooltips"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.50899def.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>